---
import PublicLayout from "@/layouts/PublicLayout.astro";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Separator } from "@/components/ui/separator";

// Placeholder data matching Person schema
const commanders = [
  {
    id: "1",
    name: "พลเอก ประยุทธ์ จันทร์โอชา",
    rank: "พลเอก",
    role: "ผู้บัญชาการทหารบก",
    portrait: "/commander-placeholder.jpg",
    unitId: "main-unit",
    order: 1,
    bio: "ผู้บัญชาการทหารบกแห่งราชอาณาจักรไทย",
    unit: { name: "กองทัพบก" }
  },
  {
    id: "2",
    name: "พลโท สมชาย ใจดี",
    rank: "พลโท",
    role: "ผู้บัญชาการมณฑลทหารบกที่ 16",
    portrait: "/commander-placeholder.jpg",
    unitId: "16th-circle",
    order: 2,
    bio: "ผู้บัญชาการมณฑลทหารบกที่ 16",
    unit: { name: "มณฑลทหารบกที่ 16" }
  },
  {
    id: "3",
    name: "พลตรี วิชัย รักชาติ",
    rank: "พลตรี",
    role: "รองผู้บัญชาการมณฑลทหารบกที่ 16",
    portrait: "/commander-placeholder.jpg",
    unitId: "16th-circle",
    order: 3,
    bio: "รองผู้บัญชาการมณฑลทหารบกที่ 16",
    unit: { name: "มณฑลทหารบกที่ 16" }
  },
  {
    id: "4",
    name: "พันเอก อำนาจ สุขใจ",
    rank: "พันเอก",
    role: "หัวหน้ากองบัญชาการ",
    portrait: "/commander-placeholder.jpg",
    unitId: "command-unit",
    order: 4,
    bio: "หัวหน้ากองบัญชาการมณฑลทหารบกที่ 16",
    unit: { name: "กองบัญชาการ" }
  },
  {
    id: "5",
    name: "พันเอก สมบัติ มั่งมี",
    rank: "พันเอก",
    role: "หัวหน้ากองยุทธการ",
    portrait: "/commander-placeholder.jpg",
    unitId: "operations-unit",
    order: 5,
    bio: "หัวหน้ากองยุทธการมณฑลทหารบกที่ 16",
    unit: { name: "กองยุทธการ" }
  },
  {
    id: "6",
    name: "พันเอก ธนา ชัยชนะ",
    rank: "พันเอก",
    role: "หัวหน้ากองส่งกำลังบำรุง",
    portrait: "/commander-placeholder.jpg",
    unitId: "logistics-unit",
    order: 6,
    bio: "หัวหน้ากองส่งกำลังบำรุงมณฑลทหารบกที่ 16",
    unit: { name: "กองส่งกำลังบำรุง" }
  },
  {
    id: "7",
    name: "พันเอก รณชัย วีระกุล",
    rank: "พันเอก",
    role: "หัวหน้ากองข่าว",
    portrait: "/commander-placeholder.jpg",
    unitId: "intelligence-unit",
    order: 7,
    bio: "หัวหน้ากองข่าวมณฑลทหารบกที่ 16",
    unit: { name: "กองข่าว" }
  },
  {
    id: "8",
    name: "พันเอก ประสิทธิ์ เกียรติศักดิ์",
    rank: "พันเอก",
    role: "หัวหน้ากองพลาธิการ",
    portrait: "/commander-placeholder.jpg",
    unitId: "personnel-unit",
    order: 8,
    bio: "หัวหน้ากองพลาธิการมณฑลทหารบกที่ 16",
    unit: { name: "กองพลาธิการ" }
  },
  {
    id: "9",
    name: "พันเอก วีระชัย สงบสุข",
    rank: "พันเอก",
    role: "หัวหน้ากองยุทธโยธา",
    portrait: "/commander-placeholder.jpg",
    unitId: "engineering-unit",
    order: 9,
    bio: "หัวหน้ากองยุทธโยธามณฑลทหารบกที่ 16",
    unit: { name: "กองยุทธโยธา" }
  },
  {
    id: "10",
    name: "พันเอก สุรชัย มั่นคง",
    rank: "พันเอก",
    role: "หัวหน้ากองกิจการพลเรือน",
    portrait: "/commander-placeholder.jpg",
    unitId: "civil-affairs-unit",
    order: 10,
    bio: "หัวหน้ากองกิจการพลเรือนมณฑลทหารบกที่ 16",
    unit: { name: "กองกิจการพลเรือน" }
  },
  {
    id: "11",
    name: "พันเอก ธีรพงษ์ ประชาชน",
    rank: "พันเอก",
    role: "หัวหน้ากองกำลังพล",
    portrait: "/commander-placeholder.jpg",
    unitId: "manpower-unit",
    order: 11,
    bio: "หัวหน้ากองกำลังพลมณฑลทหารบกที่ 16",
    unit: { name: "กองกำลังพล" }
  },
  {
    id: "12",
    name: "พันเอก ณรงค์ฤทธิ์ แข็งแกร่ง",
    rank: "พันเอก",
    role: "หัวหน้ากองสรรพาวุธ",
    portrait: "/commander-placeholder.jpg",
    unitId: "ordnance-unit",
    order: 12,
    bio: "หัวหน้ากองสรรพาวุธมณฑลทหารบกที่ 16",
    unit: { name: "กองสรรพาวุธ" }
  }
];
---

<PublicLayout>
  <slot slot="head">
    <title>ผู้นำและผู้บังคับบัญชา - มณฑลทหารบกที่ 16</title>
    <meta
      name="description"
      content="พบกับผู้นำและผู้บังคับบัญชาของมณฑลทหารบกที่ 16 รวมถึงโครงสร้างการบังคับบัญชา"
    />
    <style>
      .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }
    </style>
    <script>
      function scrollLevel(containerId, direction) {
        const container = document.getElementById(containerId);
        if (container) {
          container.scrollBy({
            left: direction,
            behavior: 'smooth'
          });
        }
      }

      // Show/hide arrows based on scroll position
      function updateArrows() {
        const containers = [
          { id: 'level2-scroll', left: 'level2-left-arrow', right: 'level2-right-arrow' },
          { id: 'level3-scroll', left: 'level3-left-arrow', right: 'level3-right-arrow' }
        ];
        containers.forEach(({ id, left, right }) => {
          const container = document.getElementById(id);
          const leftArrow = document.getElementById(left);
          const rightArrow = document.getElementById(right);

          if (container && leftArrow && rightArrow) {
            const isAtStart = container.scrollLeft === 0;
            const isAtEnd = container.scrollLeft >= container.scrollWidth - container.clientWidth - 1;

            leftArrow.style.opacity = isAtStart ? '0' : '1';
            rightArrow.style.opacity = isAtEnd ? '0' : '1';
          }
        });
      }

      // Initialize arrow visibility
      document.addEventListener('DOMContentLoaded', () => {
        updateArrows();
        ['level2-scroll', 'level3-scroll'].forEach(id => {
          const container = document.getElementById(id);
          if (container) {
            container.addEventListener('scroll', updateArrows);
          }
        });
      });
    </script>
  </slot>
  <slot slot="body">
    <main class="min-h-screen bg-background">
      <!-- Hero Section -->
      <section class="relative py-20 px-4 bg-gradient-to-br from-[var(--primary)] to-[var(--primary)]/80 text-[var(--primary-foreground)]">
        <div class="absolute inset-0 bg-black/10"></div>
        <div class="relative max-w-4xl mx-auto text-center">
          <h1 class="text-4xl md:text-5xl font-bold mb-6">ผู้นำและผู้บังคับบัญชา</h1>
          <p class="text-xl opacity-90 max-w-2xl mx-auto">
            พบกับผู้นำและผู้บังคับบัญชาที่นำทีมมณฑลทหารบกที่ 16
            ในการปฏิบัติภารกิจเพื่อความสงบสุขของชาติ
          </p>
        </div>
      </section>

      <!-- Command Structure -->
      <section class="py-16 px-4">
        <div class="max-w-7xl mx-auto">
          <h2 class="text-3xl font-bold text-center mb-4">โครงสร้างการบังคับบัญชา</h2>
          <p class="text-muted-foreground text-center mb-12 max-w-2xl mx-auto">
            แผนผังการบังคับบัญชาที่แสดงถึงสายการบังคับบัญชาและความรับผิดชอบของแต่ละหน่วย
          </p>

          <!-- Commander Tree -->
          <div class="space-y-8">
            <!-- Top Level - Army Commander -->
            <div class="flex justify-center">
              <Card className="w-80 shadow-xl border-2 border-[var(--primary)]">
                <CardContent className="p-6 text-center h-full flex flex-col justify-between">
                  <div>
                    <div class="w-24 h-24 mx-auto mb-4 rounded-full bg-gradient-to-br from-[var(--primary)] to-[var(--primary)]/80 flex items-center justify-center text-[var(--primary-foreground)] text-2xl font-bold">
                      {commanders[0].name.split(' ')[0][0]}{commanders[0].name.split(' ')[1][0]}
                    </div>
                    <Badge variant="secondary" className="mb-2">{commanders[0].rank}</Badge>
                    <h3 class="text-lg font-bold mb-2">{commanders[0].name}</h3>
                    <p class="text-[var(--primary)] font-semibold mb-2">{commanders[0].role}</p>
                    <p class="text-sm text-muted-foreground">{commanders[0].unit.name}</p>
                  </div>
                </CardContent>
              </Card>
            </div>

            <!-- Connector -->
            <div class="flex justify-center">
              <div class="w-1 h-12 bg-gradient-to-b from-[var(--primary)] to-[var(--muted)]"></div>
            </div>

            <!-- Second Level - Circle Commander and Deputy -->
            <div class="relative group">
              <div class="flex gap-8 overflow-x-auto scrollbar-hide scroll-smooth" id="level2-scroll">
                {commanders.slice(1, 3).map((commander) => (
                  <Card className="flex-shrink-0 w-80 shadow-lg hover:shadow-xl transition-shadow duration-300">
                    <CardContent className="p-6 text-center h-full flex flex-col justify-between">
                      <div>
                        <div class="w-24 h-24 mx-auto mb-4 rounded-full bg-gradient-to-br from-[var(--chart-2)] to-[var(--chart-2)]/80 flex items-center justify-center text-white text-2xl font-bold">
                          {commander.name.split(' ')[0][0]}{commander.name.split(' ')[1][0]}
                        </div>
                        <Badge variant="outline" className="mb-2">{commander.rank}</Badge>
                        <h3 class="text-lg font-bold mb-2">{commander.name}</h3>
                        <p class="text-[var(--chart-2)] font-semibold mb-2">{commander.role}</p>
                        <p class="text-sm text-muted-foreground">{commander.unit.name}</p>
                      </div>
                    </CardContent>
                  </Card>
                ))}
              </div>
              <!-- Scroll Arrows -->
              <button
                class="absolute left-0 top-1/2 -translate-y-1/2 bg-[var(--background)]/80 hover:bg-[var(--background)] text-[var(--foreground)] p-2 rounded-full shadow-lg transition-all duration-200 opacity-0 group-hover:opacity-100"
                onclick="scrollLevel('level2-scroll', -344)"
                id="level2-left-arrow"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
              </button>
              <button
                class="absolute right-0 top-1/2 -translate-y-1/2 bg-[var(--background)]/80 hover:bg-[var(--background)] text-[var(--foreground)] p-2 rounded-full shadow-lg transition-all duration-200 opacity-0 group-hover:opacity-100"
                onclick="scrollLevel('level2-scroll', 344)"
                id="level2-right-arrow"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </button>
            </div>

            <!-- Connector -->
            <div class="flex justify-center">
              <div class="w-1 h-12 bg-gradient-to-b from-[var(--muted)] to-[var(--chart-3)]"></div>
            </div>

            <!-- Third Level - Department Heads -->
            <div class="relative group">
              <div class="flex gap-6 overflow-x-auto scrollbar-hide scroll-smooth" id="level3-scroll">
                {commanders.slice(3).map((commander) => (
                  <Card className="flex-shrink-0 w-80 shadow-md hover:shadow-lg transition-shadow duration-300">
                    <CardContent className="p-6 text-center h-full flex flex-col justify-between">
                      <div>
                        <div class="w-24 h-24 mx-auto mb-4 rounded-full bg-gradient-to-br from-[var(--chart-3)] to-[var(--chart-3)]/80 flex items-center justify-center text-white text-2xl font-bold">
                          {commander.name.split(' ')[0][0]}{commander.name.split(' ')[1][0]}
                        </div>
                        <Badge variant="outline" className="mb-2">{commander.rank}</Badge>
                        <h3 class="text-lg font-bold mb-2">{commander.name}</h3>
                        <p class="text-[var(--chart-3)] font-semibold mb-2">{commander.role}</p>
                        <p class="text-sm text-muted-foreground">{commander.unit.name}</p>
                      </div>
                    </CardContent>
                  </Card>
                ))}
              </div>
              <!-- Scroll Arrows -->
              <button
                class="absolute left-0 top-1/2 -translate-y-1/2 bg-[var(--background)]/80 hover:bg-[var(--background)] text-[var(--foreground)] p-2 rounded-full shadow-lg transition-all duration-200 opacity-0 group-hover:opacity-100"
                onclick="scrollLevel('level3-scroll', -344)"
                id="level3-left-arrow"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
              </button>
              <button
                class="absolute right-0 top-1/2 -translate-y-1/2 bg-[var(--background)]/80 hover:bg-[var(--background)] text-[var(--foreground)] p-2 rounded-full shadow-lg transition-all duration-200 opacity-0 group-hover:opacity-100"
                onclick="scrollLevel('level3-scroll', 344)"
                id="level3-right-arrow"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </section>
    </main>
  </slot>
</PublicLayout>
